$ClientID       = ""   # Insert your application's Client ID (Called Application ID in the Portal)
$ClientSecret   = ""   # Insert your application's Client Key/Secret string
$loginURL       = "https://login.microsoftonline.com"     # AAD Instance; for example https://login.microsoftonline.com
$tenantdomain   = "yourTenantName.onmicrosoft.com"    # AAD Tenant; for example, contoso.onmicrosoft.com
$resource       = "https://graph.windows.net"             # Azure AD Graph API resource URI
$body           = @{grant_type="client_credentials";resource=$resource;client_id=$ClientID;client_secret=$ClientSecret}
$oauth          = Invoke-RestMethod -Method Post -Uri $loginURL/$tenantdomain/oauth2/token?api-version=1.0 -Body $body

$headerParams = @{'Authorization'="$($oauth.token_type) $($oauth.access_token)"}
$url = 'https://graph.windows.net/' + $tenantdomain + "/users?api-version=2013-11-08"
$results=Invoke-RestMethod -UseBasicParsing -Headers $headerParams -Uri $url
$results.value